var pmeAction,pmeHelp,pmeRowIndex,pmeContentIndex,pmeContent;jQuery(function($){var justClicked,editing={state:false,row:null,blk:null},$body=$("body"),$acts=$("#pme-actions"),$toolbars=$(".pme-toolbar"),$contentToolbars=$toolbars.filter("#pme-content-format, #pme-content-actions"),doneEditing=function(){$toolbars.hide(500);$(".pme-editing").removeClass("pme-editing");editing.blk.prop("contentEditable",false);editing.state=false;editing.row=null;editing.blk=null},actions={close:function(){},styleRow:function(){var $t=editing.blk},editContent:function(){editing.state=true;var $t=editing.blk;$t.addClass("pme-editing");$t.prop("contentEditable",true);$contentToolbars.show(500)},styleContent:function(){}},contentActions={left:function(){document.execCommand("justifyLeft")},center:function(){document.execCommand("justifyCenter")},right:function(){document.execCommand("justifyRight")},bold:function(){document.execCommand("bold")},italic:function(){document.execCommand("italic")},element:function(tagName){var sel=document.getSelection(),$el=$(sel.anchorNode.parentElement);if($el.css("display")!="block"){$el=$el.parentsUntil(".ppb-block").filter(function(){return $(this).css("display")==="block"}).first()}if($el.length){$el.replaceWith($("<"+tagName+">"+$el.html()+"</"+tagName+">"))}},save:function(){doneEditing()},discard:function(){doneEditing()}};$body.on("click",".ppb-row[data-index]",function(e){var $t=$(e.target);if(justClicked){editing.row=$t.closest(".ppb-row[data-index]");editing.blk=$t.closest(".ppb-block[data-index]");pmeRowIndex=editing.row.data("index");pmeContentIndex=editing.blk.data("index");$acts.fadeIn().addClass("active")}else{justClicked=!editing.state;setTimeout(function(){justClicked=false},500)}});pmeAction=function(action){$acts.removeClass("active").fadeOut();if(typeof actions[action]==="function"){actions[action]()}};pmeContent=function(action,args){if(typeof contentActions[action]==="function"){contentActions[action](args)}};pmeHelp=function(that){$(that).toggleClass("active")}});